import os, sys
import subprocess

###############################
rootDir = sys.argv[1]
bmName = sys.argv[2]
numFIGroups = int(sys.argv[3])
maxFIperGroup = int(sys.argv[4])
# noOfThreads = int(sys.argv[2])
###############################

curDir = os.getcwd()
rootDirAbs = os.path.realpath(rootDir)
# os.chdir(rootDir)
# Read input list
inputList = open('input_list.txt', 'r').readlines()

for eachInput in inputList:
	if eachInput != "\n":
		# Launch FI for the input
		eachInput = eachInput.replace("\n", "")
		inputFolderName = bmName + "-" + eachInput.replace(" ", "-")
		inputFolderPath = os.path.join(rootDirAbs, inputFolderName)
		os.system("python getFailureRates.py " + inputFolderPath + " " + bmName + " " + str(numFIGroups) + " " + str(maxFIperGroup) + " \"" + eachInput + "\"")
		print("measurement done for input: " + eachInput)

os.chdir(curDir)

